(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[106],{7590:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/memos",function(){return n(3107)}])},3425:function(e,t,n){"use strict";n.d(t,{H:function(){return i}});let i=n(8598).ZP.div.withConfig({componentId:"sc-47295c3a-0"})(["font-style:italic;font-size:0.875rem;color:",";text-align:right;"],e=>e.theme.colors.textGray2)},3891:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var i=n(1527);n(959);var r=n(8598);function o(e){let{title:t,Icon:n,children:r,...o}=e;return(0,i.jsxs)(s,{...o,children:[(0,i.jsxs)(a,{children:[n&&(0,i.jsx)(n,{size:"1em",style:{marginRight:"0.5em"}}),t]}),(0,i.jsx)("div",{style:{paddingTop:"0.5rem"},children:r})]})}let s=r.ZP.section.withConfig({componentId:"sc-dcdfb575-0"})(["margin-top:1.5rem;padding:0.5rem 1rem;color:",";"],e=>e.theme.colors.textSecondary),a=r.ZP.div.withConfig({componentId:"sc-dcdfb575-1"})(["font-weight:600;text-transform:uppercase;font-size:0.875rem;color:",";"],e=>e.theme.colors.textGray2)},8646:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}});var i=n(1527),r=n(4042),o=n(8886),s=n(3130),a=n(12),l=n.n(a),c=n(959),d=n(8598),h=n(8761),u=n(9802),m=n(1985),g=n(3891);let p=l()(()=>Promise.all([n.e(996),n.e(595),n.e(551),n.e(822)]).then(n.bind(n,7822)),{loadableGenerated:{webpack:()=>[7822]}});function f(){let e=(0,c.useContext)(d.Ni),[t,n]=(0,c.useState)([{objectId:"0x00",comment:"等等，好像没有评论哦~"}]),[a,l]=(0,c.useState)(!1);return(0,c.useEffect)(()=>{let e=encodeURIComponent(globalThis.location.pathname);fetch(h.d.walineApi+"/comment?path="+e+"&pageSize=10&page=1&lang=en-US&sortBy=insertedAt_desc").then(e=>e.json()).then(e=>{n(e.data)})},[]),(0,i.jsxs)(i.Fragment,{children:[a&&(0,i.jsx)(m.Z,{isModel:a,setModel:l,style:{background:null==e?void 0:e.colors.bgMask},children:(0,i.jsx)(w,{children:(0,i.jsx)(p,{onClick:e=>e.stopPropagation()})})}),(0,i.jsxs)(g.Z,{title:r.ZP.t("latestcomments"),Icon:o.Z,children:[(0,i.jsx)(x,{children:t.map(e=>(0,i.jsx)("li",{children:e.comment.replace(/<[^>]*>/g,"")},e.objectId))}),(0,i.jsxs)(b,{children:[(0,i.jsx)(s.Z,{size:"1em",style:{marginRight:"0.5em"}}),(0,i.jsx)("span",{onClick:()=>l(!0),children:"给我留言"})]})]})]})}let x=d.ZP.div.withConfig({componentId:"sc-49afb8e3-0"})(["font-size:0.9rem;li{list-style:none;height:1.5em;overflow:hidden;}"]),b=d.ZP.span.withConfig({componentId:"sc-49afb8e3-1"})(["margin-top:2.5rem;height:2.5rem;max-width:8rem;padding:0 0.5rem;border-radius:2rem;font-weight:600;color:",";cursor:pointer;background:",";display:flex;align-items:center;justify-content:center;@media screen and (max-width:780px){max-width:unset;background:",";}&:hover{color:",";","}"],e=>e.theme.colors.textPrimary,e=>e.theme.colors.bg,e=>e.theme.colors.bg2,e=>e.theme.colors.accent,u.$_),w=d.ZP.div.withConfig({componentId:"sc-49afb8e3-2"})(["height:100%;width:100%;padding-top:64px;overflow-y:auto;&>div{max-width:min(90%,640px);cursor:default;}"])},2388:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return x},useImageBroswerStore:function(){return f}});var i=n(1527),r=n(889),o=n(8314),s=n(959),a=n(8598),l=n(6856),c=n(6554),d=n(7666),h=n(1985),u=n(31);let m={isPressed:!1,startpos:[0,0,0],starttime:0,trans:[0,0],direction:0,bias:0},g=e=>e.type.includes("touch")?{x:e.touches[0].clientX,y:e.touches[0].clientY}:{x:e.clientX,y:e.clientY},p=(e,t)=>e.type.includes("touch")?"move"===t?"touchmove":"touchend":"move"===t?"mousemove":"mouseup",f=(0,l.Ue)(e=>({isModel:!1,setisModel:t=>e(()=>({isModel:t})),imagesData:[],setImagesData:t=>e(()=>({imagesData:t})),currentIndex:0,setCurrentIndex:t=>e(()=>({currentIndex:t}))}));function x(){let e=f(e=>e),t=f(e=>e.imagesData),[n,a]=(0,s.useState)({curr:f(e=>e.currentIndex),last:f(e=>e.currentIndex)});n.curr>t.length-1&&console.error("uncaught invalid image index:",n,"in length",t.length);let l=(0,s.useCallback)(()=>{n.curr>0&&a({curr:n.curr-1,last:n.curr})},[n,a]),x=(0,s.useCallback)(()=>{n.curr<t.length-1&&a({curr:n.curr+1,last:n.curr})},[n,a,t]),k=(0,s.useCallback)(()=>{},[]),C=(0,s.useCallback)(e=>{"ArrowLeft"===e.key?l():"ArrowRight"===e.key&&x()},[x,l]);(0,c.I)("keydown",C);let{bind:S,trans:P,direction:Z,isBeforeUnmount:I}=function(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:17,[o,a]=(0,s.useState)(),[l,c]=(0,s.useState)([0,0]),[d,h]=(0,s.useState)(0),[f,x]=(0,s.useState)(!1),b=(0,s.useCallback)((e,t)=>n=>{if(n.stopPropagation(),n.target){m.isPressed=!0,m.starttime=Date.now(),m.startpos=[g(n).x,g(n).y,n.target.scrollTop];let i=n.target;n.type.includes("touch")&&i.addEventListener(p(n,"move"),e,{passive:!1}),i.addEventListener(p(n,"end"),t,{once:!0})}},[]),w=(0,s.useCallback)(e=>{if(e.stopPropagation(),e.type.includes("touch")&&e.touches.length>1){e.preventDefault();return}if(e.target&&m.isPressed){let t=g(e).x-m.startpos[0],n=g(e).y-m.startpos[1];if(m.trans=[t,n],0!==m.direction)c("x"===m.direction?[t-m.bias,0]:[0,n-m.bias]);else if(Math.abs(t)>20||Math.abs(n)>20){let e=Math.abs(t)>Math.abs(n)?"x":"y";m.bias="x"===e?t:n,m.direction=e,h(e),c("x"===e?[t-m.bias,0]:[0,n-m.bias])}}},[]),y=(0,s.useCallback)(r=>o=>{o.stopPropagation(),Date.now()-m.starttime<140&&5>Math.abs(m.trans[0])&&5>Math.abs(m.trans[1])?(x(!0),setTimeout(()=>{e.setisModel(!1),x(!1)},300)):"x"===m.direction&&(m.trans[0]<-60?n():m.trans[0]>60?t():i()),m.isPressed=!1,m.startpos=[0,0,0],m.trans=[0,0],c([0,0]),m.direction=0,m.bias=0,h(0),o.target.removeEventListener("touchmove",r)},[e,t,n,i]);return(0,s.useEffect)(()=>{let e=(0,u.P)(w,r),t=b(e,y(e));a(()=>t)},[y,w,b,r]),{trans:l,direction:d,isBeforeUnmount:f,bind:{onTouchStart:o,onMouseDown:o}}}(e,l,x,k,20),M=(0,s.useMemo)(()=>"x"===Z&&P[0]>60,[P,Z]),T=(0,s.useMemo)(()=>"x"===Z&&P[0]<-60,[P,Z]),E=(0,d.aA)(),N=(0,d.hV)(),L=(0,s.useMemo)(()=>"x"===Z?{transition:"transform 0.05s linear",transform:"translate3d(".concat(P[0]-n.curr*N,"px, 0px, 0px)"),width:"".concat(N*t.length,"px")}:{transition:"transform 0.5s ease",transform:"translate3d(".concat(-n.curr*N,"px, 0px, 0px)"),width:"".concat(N*t.length,"px")},[P,Z,n.curr,N,t.length]),z=(0,s.useMemo)(()=>I?{opacity:0,transition:"opacity 0.3s ease"}:{},[I]),$=(0,s.useMemo)(()=>{let e=n.curr;return[e>0?{i:e-1,data:t[e-1]}:{i:e-1,data:void 0},{i:e,data:t[e]},e+1<t.length?{i:e+1,data:t[e+1]}:{i:e+1,data:void 0}]},[t,n.curr]),D=(0,s.useMemo)(()=>$.map(e=>{let t=N*e.i,n={transform:"translateX(".concat(t,"px)"),width:"".concat(N,"px"),height:"100%"};return e.data?(0===e.data.width||0===e.data.height?1:e.data.width/e.data.height)>.6||e.data.height<E?{...n,display:"flex",alignItems:"center"}:{...n,overflowY:"auto"}:n}),[$,E,N]),H=(0,s.useMemo)(()=>"x"===Z?{overflowY:"hidden"}:{},[Z]),_=(0,s.useCallback)(e=>{let t=0===e.width||0===e.height?1:e.width/e.height;return t>=2?{maxWidth:N,maxHeight:.9*E+"px"}:t>.6||e.height<E?{maxWidth:N,maxHeight:E+"px"}:{maxWidth:.95*N}},[E,N]);return(0,i.jsxs)(h.Z,{isModel:!0,setModel:e.setisModel,style:{...z,background:"#1d1d1d"},children:[(0,i.jsx)(j,{...S,onClick:e=>e.stopPropagation(),style:L,children:$.map((e,t)=>(0,i.jsx)(b,{style:{...D[t],...H},children:e.data&&(0,i.jsx)(w,{src:"loaded"===e.data.ok?e.data.src:"",alt:e.data.ok,style:_(e.data)})},e.i))}),n.curr>0&&(0,i.jsx)(v,{$isLeft:!0,$isShown:M,onClick:e=>{e.stopPropagation(),l()},children:(0,i.jsx)(r.Z,{})}),n.curr<t.length-1&&(0,i.jsx)(v,{$isLeft:!1,$isShown:T,onClick:e=>{e.stopPropagation(),x()},children:(0,i.jsx)(o.Z,{})}),(0,i.jsxs)(y,{children:[n.curr+1,"/",t.length," \xa0|\xa0",(0,i.jsx)("span",{onClick:t=>{t.stopPropagation(),e.setisModel(!1)},children:"关闭"})]})]})}let b=a.ZP.div.withConfig({componentId:"sc-74a0f7de-0"})(["position:absolute;will-change:transform;"]),w=a.ZP.img.withConfig({componentId:"sc-74a0f7de-1"})(["display:block;margin:0 auto;&::after{content:attr(alt);}"]),y=a.ZP.div.withConfig({componentId:"sc-74a0f7de-2"})(["position:fixed;display:flex;justify-content:center;align-items:center;top:0.5rem;right:0.5rem;height:2.5rem;border-radius:1.25rem;padding:0 1rem;background:#5b5b5bbd;color:white;backdrop-filter:blur(5px);-webkit-backdrop-filter:blur(5px);&:hover{opacity:1;}"]),v=a.ZP.div.withConfig({componentId:"sc-74a0f7de-3"})(["position:fixed;bottom:calc(50vh - 2.5rem);display:flex;justify-content:center;align-items:center;cursor:pointer;width:2.5rem;height:2.5rem;padding:0rem;color:white;opacity:0.5;background:#5b5b5bbd;font-size:1.25rem;border-radius:50%;"," @media screen and (max-width:580px){"," transition:left 0.3s linear,right 0.3s linear;}&:hover{opacity:1;backdrop-filter:blur(5px);-webkit-backdrop-filter:blur(5px);}"],e=>e.$isLeft?"left: 1rem;":"right: 1rem;",e=>e.$isLeft?e.$isShown?"left: 1rem;":"left: -2.5rem;":e.$isShown?"right: 1rem;":"right: -2.5rem;"),j=a.ZP.div.withConfig({componentId:"sc-74a0f7de-4"})(["width:100%;height:100%;overflow-x:clip;overflow-y:hidden;position:relative;cursor:default;will-change:transform;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;"])},9277:function(e,t,n){"use strict";n.d(t,{l:function(){return x},_:function(){return b}});var i=n(1527),r=n(959),o=n(8598),s=n(2e3),a=n(8761),l=n(2076),c=n(9802),d=n(5809),h=n(4261),u=n(2388);function m(e){var t,n,o;let{imgsmd:s}=e,a=(0,u.useImageBroswerStore)(e=>e),[l,c]=(0,r.useState)(Array(s.length).fill(1).map((e,t)=>({ok:"loading",index:t,src:"",width:1,height:1,alt:""})));return((0,r.useEffect)(()=>{(async function(){let e=s.map(async(e,t)=>{let n;let i=function(e){let t=/!\[(.*?)\]\((.*?)\)/.exec(e);return t?{alt:t[1],url:t[2]}:null}(e);if(!i)return{ok:"failed",index:t,src:"",width:0,height:0,alt:""};let{url:r,alt:o}=i,s=new Image,a=new Promise((e,n)=>{s.onload=()=>e(s),s.onerror=()=>n({ok:"failed",index:t,src:"",width:0,height:0,alt:o}),s.src=r});return(await a.catch(e=>{n=e}),n)?n:{ok:"loaded",index:t,src:r,width:s.width,height:s.height,alt:o}});try{let t=await Promise.all(e);c(t)}catch(e){console.error("Error loading images:",e)}})()},[s,c]),0===s.length)?null:(0,i.jsx)(i.Fragment,{children:1===s.length?(0,i.jsx)("div",{style:{height:"250px",paddingLeft:"40px"},children:(0,i.jsxs)(p,{style:{maxWidth:"100%",height:"100%",aspectRatio:l[0]?l[0].width/l[0].height>2.5?2.5:l[0].width/l[0].height<.75?.75:l[0].width/l[0].height:2},children:[" ",(0,i.jsx)("img",{loading:"lazy",src:(null===(t=l[0])||void 0===t?void 0:t.ok)==="loaded"?null===(n=l[0])||void 0===n?void 0:n.src:"",alt:null===(o=l[0])||void 0===o?void 0:o.ok}),(0,i.jsx)(g,{onClick:e=>{e.stopPropagation(),a.setCurrentIndex(0),a.setImagesData(l),a.setisModel(!0)}})]})}):(0,i.jsx)(f,{children:l.map((e,t)=>(0,i.jsxs)(p,{onTouchEnd:e=>{e.stopPropagation()},children:[" ",(0,i.jsx)("img",{loading:"lazy",src:"loaded"===e.ok?e.src:"",alt:e.ok}),(0,i.jsx)(g,{onClick:e=>{e.stopPropagation(),a.setCurrentIndex(t),a.setImagesData(l),a.setisModel(!0)}})]},t))})})}let g=o.ZP.div.withConfig({componentId:"sc-879915bc-0"})(["position:absolute;top:0;left:0;width:100%;height:100%;"]),p=o.ZP.div.withConfig({componentId:"sc-879915bc-1"})(["border-radius:0.5rem;background:",";position:relative;overflow:hidden;aspect-ratio:1;cursor:zoom-in;user-select:none;-webkit-user-select:none;& img{position:absolute;-o-object-fit:cover;object-fit:cover;width:100%;height:100%;top:0;left:0;}& img:after{content:attr(alt);background:",";color:",";font-weight:bold;display:block;position:absolute;top:0;height:100%;width:100%;text-align:left;padding:1em;word-break:break-all;}"],e=>e.theme.colors.bg2,e=>e.theme.colors.bg2,e=>e.theme.colors.uiLineGray),f=o.ZP.div.withConfig({componentId:"sc-879915bc-2"})(["display:grid;grid-template-columns:repeat(4,1fr);gap:5px;margin-top:8px;padding-left:40px;@media screen and (max-width:580px){grid-template-columns:repeat(3,1fr);}"]);function x(e){let{source:t,setSearchText:n,triggerHeightChange:l,...c}=e,[h,u]=(0,r.useState)(!0),g=(0,r.useContext)(o.Ni),p=r.useRef(null),f=t.length>200,x=(0,r.useMemo)(()=>{let e=new Date(t.id);return"Invalid Date"!==e.toString()?(0,s.l0)(e):t.id},[t.id]);return(0,i.jsxs)(w,{...c,$isCollapse:!1!==f&&h,ref:p,children:[(0,i.jsxs)("div",{className:"content",children:[(0,i.jsxs)(j,{children:[(0,i.jsx)("img",{className:"avatar",src:g.assets.favico,alt:a.d.author}),(0,i.jsxs)("div",{className:"meta-text",children:[(0,i.jsx)("span",{className:"author",children:a.d.author}),(0,i.jsx)("span",{className:"meta-sm",children:"•"}),(0,i.jsx)("span",{className:"meta-sm date",children:x}),(0,i.jsxs)("span",{className:"meta-sm word-count",children:[t.length,"\xa0字"]})]})]}),(0,i.jsx)(v,{$bottomSpace:f,children:(0,d.n)(t.code,n)}),(0,i.jsx)(y,{$isCollapse:h,$isShown:f,children:(0,i.jsx)("div",{onClick:function(e){if(!h){let e=p.current;if(e){let t=e.getBoundingClientRect().top;(t<0||t>window.innerHeight)&&globalThis.scrollTo({top:t+globalThis.scrollY})}}u(!h),p.current&&l&&l(!0)},className:"rd-more",children:(0,i.jsx)("span",{children:h?"展开全文":"收起"})})})]}),0!==t.imgsmd.length&&(0,i.jsx)(m,{imgsmd:t.imgsmd})]})}function b(){return(0,i.jsx)(w,{$isCollapse:!1,children:(0,i.jsx)("span",{style:{opacity:.35,fontWeight:"bold"},children:"Loading..."})})}let w=o.ZP.section.withConfig({componentId:"sc-425f4fe2-0"})(["background:",";margin:0.625rem 0;padding:1.25rem 1.5rem;border-radius:0.75rem;animation:"," .3s ease;@media screen and (max-width:580px){padding:1rem;border-radius:unset;}& > .content{position:relative;height:",";overflow:hidden;}"],e=>e.theme.colors.bg,l.r$,e=>!0===e.$isCollapse?"18.2rem":"auto"),y=o.ZP.div.withConfig({componentId:"sc-425f4fe2-1"})(["display:",";position:absolute;bottom:0;width:100%;height:7rem;text-align:right;color:",";"," .rd-more{font-size:0.875rem;letter-spacing:0.02rem;margin-top:5.5rem;;cursor:pointer;span{transition:box-shadow .3s;margin-right:0.5rem;}}& .rd-more:hover span{","}"],e=>!0===e.$isShown?"block":"none",e=>e.theme.colors.accent,e=>!0===e.$isCollapse?e.theme.colors.maskGradient:"",()=>c.XC.f),v=(0,o.ZP)(h.j).withConfig({componentId:"sc-425f4fe2-2"})(["padding-bottom:",";padding-left:40px;p,ul,ol{line-height:1.625rem;}p{margin:0.5rem 0;}h1,h2,h3,h4,h5,h6{font-size:1rem;}& .tag{color:",";}& .tag:hover{cursor:pointer;color:",";}"],e=>!0===e.$bottomSpace?"2rem":"inherit",e=>e.theme.colors.accent,e=>e.theme.colors.accentHover),j=o.ZP.div.withConfig({componentId:"sc-425f4fe2-3"})(["display:flex;align-items:center;& .avatar{width:32px;height:32px;margin-right:8px;border-radius:50%;border:1px solid ",";}& .meta-text{display:flex;align-items:flex-end;font-weight:600;}& .meta-sm{color:",";font-size:0.875rem;}& .author{color:",";margin-right:0.25rem;}& .date{margin:0 0.25rem;}& .word-count{position:absolute;right:0;}"],e=>e.theme.colors.uiLineGray,e=>e.theme.colors.textGray3,e=>e.theme.colors.textSecondary)},9800:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var i=n(1527),r=n(4738);function o(e){let{info:t}=e,[n,o]=(0,r.$G)();return(0,i.jsxs)(s,{children:[(0,i.jsxs)("div",{className:"item active",children:[(0,i.jsx)("span",{className:"title",children:n("memos")}),(0,i.jsx)("span",{className:"count",children:t.memos})]}),(0,i.jsxs)("div",{className:"item",children:[(0,i.jsx)("span",{className:"title",children:n("photos")}),(0,i.jsx)("span",{className:"count",children:t.imgs})]})]})}let s=n(8598).ZP.section.withConfig({componentId:"sc-ef5d5bff-0"})(["margin-top:1.5rem;padding-left:1rem;color:",";.item{padding:0.25rem 0;margin-right:0.75rem;border-right:2px solid ",";display:flex;align-items:flex-end;}.item.active{border-right:2px solid ",";}.title{font-weight:600;margin-right:0.25rem;}.count{font-size:0.875rem;font-weight:600;color:",";vertical-align:bottom;}"],e=>e.theme.colors.textSecondary,e=>e.theme.colors.uiLineGray,e=>e.theme.colors.accent,e=>e.theme.colors.textGray2)},6834:function(e,t,n){"use strict";var i=n(1527),r=n(959),o=n(31);function s(e){let{Elem:t,index:n,source:s,placeHolder:a,setplaceHolder:l}=e,c=(0,r.useRef)(null),d=(0,r.useCallback)(()=>{if(c.current){let e=c.current.offsetHeight;l(t=>{if(t[n]===e||0===e)return t;let i=[...t];return i[n]=e,i})}},[c,l,n]);(0,r.useEffect)(()=>{let e=(0,o.P)(d,150);return globalThis.addEventListener("resize",e),()=>{globalThis.removeEventListener("resize",e)}},[c,n,l,d]);let[h,u]=(0,r.useState)(!1);(0,r.useEffect)(()=>{h&&(d(),u(!1))},[h,d]);let[m,g]=(0,r.useState)(!1);(0,r.useEffect)(()=>{d(),g(!0)},[c,d]);let p=(0,r.useMemo)(()=>a.slice(0,n).reduce((e,t)=>e+=t,0),[n,a]);return(0,i.jsx)("div",{ref:c,style:{position:"absolute",width:"100%",transform:"translateY(".concat(p,"px)"),visibility:m?"visible":"hidden"},children:t({source:s,triggerHeightChange:u})})}t.Z=e=>{let{sources:t,setSources:n,Elem:a,scrollRef:l,fetchFrom:c,batchsize:d,Loading:h}=e,[u,m]=(0,r.useState)(Array(t.length).fill(300)),[g,p]=(0,r.useState)(Array(t.length).fill(0).map((e,t)=>t)),[f,x]=(0,r.useState)(3*t.length),[b,w]=(0,r.useState)(!1),y=(0,r.useRef)({enable:!0}),v=(0,r.useMemo)(()=>u.reduce((e,t)=>e+=t,0),[u]),j=(0,r.useCallback)(e=>{let t=0;for(let n=0;n<e;n++)t+=u[n];return t},[u]);return(0,r.useEffect)(()=>{let e=null==l?void 0:l.current,i=(0,o.P)(()=>{if(!y.current.enable)return;let i=j(g[g.length-1])-j(g[0]),r=(e?e.scrollTop:globalThis.scrollY)-j(g[0]),o=r+globalThis.innerHeight-(e&&e.getBoundingClientRect().y>0?e.getBoundingClientRect().y:0),s=r/i;if(!isNaN(s)&&isFinite(s)&&!(s>1.5)){if(y.current={enable:!1},c&&s<.2){let e=g[0]-d;if(e<0){y.current={enable:!0};return}w(!0),c(e,d).then(e=>{if(w(!1),!e||0===e.length){y.current={enable:!0};return}let i=g.map(e=>e-g.length);e.length>g.length?i=Array(e.length-g.length).fill(0).map((t,n)=>n-e.length+g.length+i[0]).concat(i):e.length<g.length&&(i=i.slice(g.length-e.length,g.length));let r=i.concat(g),o=e.concat(t);r.length>f&&(r.splice(0-i.length,i.length),o.splice(0-i.length,i.length)),p(r),n(o),y.current={enable:!0}})}else if(c&&o/i>.8){let e=g[g.length-1]+1;w(!0),c(e,d).then(e=>{if(w(!1),!e||0===e.length){y.current={enable:!0};return}let i=g.map(e=>e+g.length);if(e.length>g.length){let t=Array(e.length-g.length).fill(0).map((e,t)=>t+i[i.length-1]);i=i.concat(t)}else e.length<g.length&&(i=i.slice(0,e.length));if(i[i.length-1]>u.length-1){let e=Array(i[i.length-1]-u.length+1).fill(300);m(u.concat(e))}let r=g.concat(i),o=t.concat(e);r.length>f&&(r.splice(0,e.length),o.splice(0,e.length)),p(r),n(o),y.current={enable:!0}})}else y.current={enable:!0}}},500);return e?e.addEventListener("scroll",i):globalThis.addEventListener("scroll",i),()=>{e?e.addEventListener("scroll",i):globalThis.removeEventListener("scroll",i)}},[y,l,c,g,n,u,j,t,d,f]),(0,i.jsxs)("div",{style:{position:"relative",width:"100%",minHeight:"".concat(v,"px")},children:[t.map((e,t)=>(0,i.jsx)(s,{index:g[t],Elem:a,source:e,placeHolder:u,setplaceHolder:m},e.id)),h&&b?(0,i.jsx)("div",{style:{position:"absolute",width:"100%",transform:"translateY(".concat(u.slice(0,u.length).reduce((e,t)=>e+=t,0),"px)")},children:(0,i.jsx)(h,{})}):null]})}},4545:function(e,t,n){"use strict";n.d(t,{e:function(){return l}});let i="/data/memos",r=async()=>fetch(i+"/status.json").then(e=>e.json()).then(e=>e),o=async(e,t)=>{let n=[Math.floor(e/10),e%10],o=[Math.floor((e+t-1)/10),(e+t-1)%10],s=await r(),a=[];for(let e=n[0];e<=o[0];e++)e>=0&&e<=s.pages&&a.push("".concat(i,"/").concat(e,".json"));let l=a.map(async(e,t)=>fetch(e).then(e=>e.json()).then(e=>0===t?o[0]-n[0]!=0?e.slice(n[1]):e.slice(n[1],o[1]+1):t===o[0]?e.slice(0,o[1]+1):e));return(await Promise.all(l)).flat()},s=async(e,t)=>{let n=(await r()).pageMap.filter(n=>{if(n.endDate<e.getTime()||n.startDate>t.getTime())return!1}).map(e=>"".concat(i,"/").concat(e,".json")).map(async(e,t)=>fetch(e).then(e=>e.json()).then(e=>e));return(await Promise.all(n)).flat()},a={static:{getMemoInfo:r,queryMemoByCount:o,queryMemoByDate:s,queryMemoTags:async()=>fetch("".concat(i,"/tags.json")).then(e=>e.json()),queryMemoImgs:async()=>[]}};function l(e){return a[e]||console.error("[client.ts] client ".concat(e," not in clientList")),a[e]}},3919:function(e,t,n){"use strict";n.d(t,{n5:function(){return l}}),n(959),n(9995),n(1527);var i=n(6276),r=n(3535),o=n(5709);function s(){return function(e){(0,o.Vn)(e,function(e,t,n){if("paragraph"===e.type){let t=[];e.children.forEach(e=>{if("text"===e.type){let n=e.value,i=function(e){let t=["#","##","###","####","#####","######"],n=[],i="",r=!1;for(let o=0;o<e.length;o++){let s=e[o];"`"===s&&(r=!r)&&(i=""),r||(i.length>0?" "===s||"\n"===s||"\r\n"===s?(t.includes(i)||n.push(i),i=""):i+=s:"#"!==s||0!==o&&" "!==e[o-1]&&"\n"!==e[o-1]||(i+=s))}return i.length>0&&n.push(i),n}(n);if(i.length>0){let e=function(e,t){if(t.includes(e))return[{text:e,isDelimiter:!0}];let n=[{text:e,isDelimiter:!1}];for(let e of t){let t=[];for(let i of n){if(i.isDelimiter){t.push(i);continue}if(""===i.text)continue;let n=i.text.split(e);for(let i=0;i<n.length&&(t.push({text:n[i],isDelimiter:!1}),i!==n.length-1);i++)t.push({text:e,isDelimiter:!0})}n=t}return n.filter(e=>""!==e.text)}(n,i),r="#"+i[i.length-1],o=e[e.length-1].text;o.endsWith(r)&&(e[e.length-1]={text:o.slice(0,o.length-r.length),isDelimiter:!1},e.push({text:r,isDelimiter:!0})),e.forEach(e=>{if(e.isDelimiter){let n={type:"mdxJsxFlowElement",name:"Tag",attributes:[{type:"mdxJsxAttribute",name:"text",value:e.text.slice(1)}]};t.push(n)}else t.push({type:"text",value:e.text})})}else t.push(e)}else t.push(e)}),e.children=t}})}}async function a(){return(await Promise.all([n.e(54),n.e(291),n.e(467)]).then(n.bind(n,3467))).compile}async function l(e){let t=await a();return{code:String(await t(e,{outputFormat:"function-body",remarkPlugins:[r.Z,s],rehypePlugins:[i.Z]}))}}},1572:function(e,t,n){"use strict";n.a(e,async function(e,i){try{var r=n(959);let e=await n.e(923).then(n.bind(n,1923)).then(e=>e.createNaive);t.Z=function(t){let{inputRef:n,setRes:i,initData:o}=t,[s,a]=(0,r.useState)(),[l,c]=(0,r.useState)({isSearch:"ready",searchText:""}),d=(0,r.useCallback)(async()=>{let t;console.debug("%% init search...");let{searchObj:n,filterRes:r}=await o();return t=e({data:n,field:["tags","content"],notifier:function(e){let t=r(e);Promise.all(t).then(e=>{i(e),c(e=>({...e,isSearch:"done"}))})},disableStreamNotify:!0}),a(t),c(e=>({...e})),t},[o,i]),h=(0,r.useCallback)(async()=>{if(!n.current)return;let e=n.current.value.trim();if(0===e.length)return;c(t=>({...t,isSearch:"searching",searchText:e})),globalThis.scrollTo({top:0});let t=s;t||(t=await d()),t.search(e.split(" "))},[d,s,n]),u=(0,r.useCallback)(function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];n.current&&(n.current.value=e,t&&h())},[h,n]);return{searchStatus:l,setsearchStatus:c,setSearchText:u,handleSearch:h,initSearch:d}},i()}catch(e){i(e)}},1)},3107:function(e,t,n){"use strict";n.a(e,async function(e,i){try{n.r(t),n.d(t,{__N_SSG:function(){return H},default:function(){return _}});var r=n(1527),o=n(4822),s=n(8999),a=n(67),l=n(3542),c=n(9343),d=n(12),h=n.n(d),u=n(3283),m=n.n(u),g=n(959),p=n(4738),f=n(8598),x=n(4538),b=n(1045),w=n(4100),y=n(3425),v=n(465),j=n(6593),k=n(3891),C=n(8646),S=n(2388),P=n(9277),Z=n(9800),I=n(6834),M=n(8725),T=n(4545),E=n(3919),N=n(6554),L=n(1572),z=n(8761),$=n(9802),D=e([L]);L=(D.then?(await D)():D)[0];let R=h()(()=>Promise.resolve().then(n.bind(n,2388)),{loadableGenerated:{webpack:()=>[2388]}});var H=!0;function _(e){let{source:t,info:n,memotags:i,client:d}=e,h=(0,g.useContext)(f.Ni),[u,$]=(0,g.useState)(t),[D,H]=(0,g.useState)(t),[_,B]=(0,g.useState)(!1),[W,X]=(0,p.$G)(),q=(0,S.useImageBroswerStore)(e=>e.isModel),[U,O]=(0,g.useState)((0,T.e)(d)),J=(0,g.useCallback)(async(e,t)=>U.queryMemoByCount(e,t).then(e=>e.length>0?Promise.all(e.map(async e=>({...e,length:e.content.length,code:(await (0,E.n5)(e.content)).code}))):void 0),[U]),V=(0,g.useRef)(null),{searchStatus:K,setsearchStatus:Q,setSearchText:ee,handleSearch:et,initSearch:en}=(0,L.Z)({inputRef:V,setRes:$,initData:async()=>{let e=Array.from({length:n.pages+1},(e,t)=>"".concat("/data/memos","/").concat(t,".json")).map(e=>fetch(e).then(e=>e.json())),t=(await Promise.all(e)).flatMap(e=>e);return{searchObj:t.map(e=>({id:e.id,title:"",content:e.content,tags:e.tags})),filterRes:e=>{let n=e.map(e=>e.id);return t.filter(e=>!!n.includes(e.id)).map(async e=>({...e,code:(await (0,E.n5)(e.content)).code,length:e.content.length}))}}}}),ei=(0,g.useCallback)(()=>{if(V.current&&""===V.current.value){$(D),Q({searchText:"",isSearch:"ready"});return}et()},[et,D,Q]);return(0,N.I)("keydown",e=>{V.current&&V.current===document.activeElement&&"Enter"===e.key&&ei()},void 0,[et]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(m(),{children:[(0,r.jsx)("title",{children:"".concat(z.d.author," - Memos")}),(0,r.jsx)(x.CommonHead,{})]}),(0,r.jsx)(v.Z,{placeHolder:!1,hideSearch:!0}),(0,r.jsxs)("main",{style:{background:null==h?void 0:h.colors.bg2},children:[(0,r.jsxs)(G,{children:[(0,r.jsx)(b.Z,{className:"button-float",Icon:o.Z,clickHandler:e=>B(e=>!e)}),(0,r.jsxs)(j.Uq,{sep:1,siderLocation:"right",children:[(0,r.jsxs)(A,{children:[(0,r.jsx)(y.H,{style:{marginRight:"1rem"},children:function(){switch(K.isSearch){case"ready":return"";case"searching":return"Searching...";case"done":return(0,r.jsxs)(r.Fragment,{children:["Results: ",u.length," memos",(0,r.jsx)("span",{style:{fontStyle:"normal",fontWeight:"bold",cursor:"pointer",marginLeft:"0.875em"},onClick:()=>{Q(e=>({...e,isSearch:"ready",searchText:""})),$(D)},children:"X"})]})}}()}),(0,r.jsx)("div",{style:{minHeight:"80vh"},children:"ready"===K.isSearch?(0,r.jsx)(I.Z,{sources:u,setSources:$,Elem:e=>(0,r.jsx)(P.l,{source:e.source,setSearchText:ee,triggerHeightChange:e.triggerHeightChange}),fetchFrom:J,batchsize:10,Loading:P._},"vl1"):"done"===K.isSearch?(0,r.jsx)(I.Z,{sources:u,setSources:$,Elem:e=>(0,r.jsx)(P.l,{source:e.source,setSearchText:ee,triggerHeightChange:e.triggerHeightChange}),batchsize:10},K.searchText):null}),(0,r.jsx)(w.Z,{style:{marginTop:"5rem"}})]}),(0,r.jsxs)(F,{$isMobileSider:_,children:[(0,r.jsxs)("div",{className:"close-btn",onClick:e=>{e.stopPropagation(),B(e=>!e)},children:["小小の菜单",(0,r.jsx)(s.Z,{size:"1.25em",style:{marginLeft:".5rem"}})]}),(0,r.jsxs)(Y,{children:[(0,r.jsx)("input",{type:"text",placeholder:W("search"),ref:V,onFocus:()=>{en()}}),(0,r.jsx)(a.Z,{className:"hover-gold",size:"1.4rem",onClick:ei})]}),(0,r.jsx)(Z.Z,{info:n}),(0,r.jsx)(k.Z,{Icon:l.Z,title:W("tags"),children:i.map(e=>(0,r.jsx)("span",{className:"hover-gold",style:{display:"inline-block",paddingRight:"0.5em"},onClick:()=>{ee("#"+e.name)},children:"#".concat(e.name)},e.name))}),z.d.friends&&(0,r.jsx)(k.Z,{title:W("friends"),Icon:c.Z,children:z.d.friends.map((e,t)=>(0,r.jsx)("div",{children:(0,r.jsx)(M.IM,{href:e.link,children:e.name})},t))}),z.d.walineApi&&""!==z.d.walineApi&&(0,r.jsx)(C.Z,{})]})]})]}),q&&(0,r.jsx)(R,{})]})]})}let G=f.ZP.div.withConfig({componentId:"sc-867b34a6-0"})(["max-width:1080px;margin:0 auto;.button-float{display:none;}@media screen and (max-width:780px){max-width:100%;.button-float{display:unset;}}@media screen and (max-width:580px){}"]),A=f.ZP.div.withConfig({componentId:"sc-867b34a6-1"})(["width:100%;padding:73px 16px 48px 16px;position:absolute;right:0;height:100vh;overflow:auto;background:",";&::-webkit-scrollbar{display:none;}@media screen and (min-width:1080px){max-width:640px;}@media screen and (max-width:780px){width:100%;}@media screen and (max-width:580px){padding-left:0;padding-right:0;}"],e=>e.theme.colors.bg2),F=f.ZP.div.withConfig({componentId:"sc-867b34a6-2"})(["max-width:15rem;padding-top:83px;padding-bottom:64px;margin:0 0.5rem;height:100vh;overflow-y:auto;&::-webkit-scrollbar{display:none;}.close-btn{display:none;z-index:1;}@media screen and (max-width:1080px){margin:0;}@media screen and (max-width:780px){position:fixed;bottom:0;max-width:unset;width:96%;right:2%;max-height:66vh;"," padding:0rem 1rem;transition:transform .3s ease;transform:",";.close-btn{position:sticky;top:0;background:inherit;display:flex;font-weight:600;justify-content:space-between;align-items:center;padding:1rem 0;"," color:",";font-size:1rem;cursor:pointer;}.close-btn:hover{color:",";}}.hover-gold{cursor:pointer;}.hover-gold:hover{color:",";}"],$.Cz,e=>e.$isMobileSider?"translateY(0)":"translateY(105%)",e=>e.$isMobileSider?null:"visibility:hidden;",e=>e.theme.colors.textGray2,e=>e.theme.colors.accent,e=>e.theme.colors.accent),Y=f.ZP.div.withConfig({componentId:"sc-867b34a6-3"})(["border-radius:2rem;background:",";color:",";display:flex;align-items:center;margin:0 0.5rem;border:1px solid ",";&:focus-within{border:1px solid ",";}input{border:none;background:inherit;line-height:2rem;color:inherit;flex:1 1 auto;width:0;margin-left:1rem;}input:focus,input:focus-visible{outline:none;}svg{margin:0 auto;flex:0  0 auto;margin:0 0.6rem 0 0.5rem;color:",";}"],e=>e.theme.colors.bg,e=>e.theme.colors.textPrimary,e=>e.theme.colors.uiLineGray,e=>e.theme.colors.accentHover,e=>e.theme.colors.uiLineGray);i()}catch(e){i(e)}})}},function(e){e.O(0,[774,818,965,593,833,888,179],function(){return e(e.s=7590)}),_N_E=e.O()}]);